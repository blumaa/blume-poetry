@import "tailwindcss";

@custom-variant dark (&:where([data-theme="dark"], [data-theme="dark"] *));

/* ==========================================================================
   Light Theme (Newsprint) - WCAG AA Compliant
   ========================================================================== */
:root {
  /* Backgrounds */
  --bg-primary: #ffffff;
  --bg-secondary: #f8f8f8;
  --bg-sidebar: #f8f8f8;
  --bg-hover: #d4d4d8;
  --bg-active: rgba(9, 9, 11, 0.1);

  /* Text - High contrast for accessibility */
  --text-primary: #09090b;
  --text-secondary: #27272a;
  --text-tertiary: #52525b;

  /* Accent - Eggplant */
  --accent: #614051;
  --accent-hover: #4a3040;

  /* Borders */
  --border: #e4e4e7;

  /* Feedback colors */
  --color-success: #16a34a;
  --color-error: #dc2626;
  --color-warning: #f59e0b;
  --color-info: #2563eb;

  /* Like button */
  --color-heart: #ef4444;

  /* Spacing */
  --sidebar-width: 280px;
  --sidebar-collapsed-width: 60px;
  --sidebar-current-width: var(--sidebar-width);
  --mobile-header-height: 56px;

  /* Typography */
  --font-serif: var(--font-crimson), Georgia, 'Times New Roman', serif;
  --font-sans: var(--font-inter), system-ui, -apple-system, sans-serif;
}

/* ==========================================================================
   Dark Theme (Inverted Newsprint) - WCAG AA Compliant
   ========================================================================== */
[data-theme="dark"] {
  /* Backgrounds - avoid pure black for better readability */
  --bg-primary: #121212;
  --bg-secondary: #1e1e1e;
  --bg-sidebar: #181818;
  --bg-hover: #3f3f46;
  --bg-active: rgba(255, 255, 255, 0.12);

  /* Text - softer than pure white to reduce eye strain */
  --text-primary: #e4e4e7;
  --text-secondary: #a1a1aa;
  --text-tertiary: #71717a;

  /* Accent - Lighter eggplant for dark mode */
  --accent: #8b5a6b;
  --accent-hover: #7a4d5c;

  /* Borders */
  --border: #3f3f46;

  /* Feedback colors - brighter for dark mode */
  --color-success: #22c55e;
  --color-error: #ef4444;
  --color-warning: #fbbf24;
  --color-info: #3b82f6;

  /* Like button */
  --color-heart: #f87171;
}

/* ==========================================================================
   Tailwind Theme Mapping
   ========================================================================== */
@theme inline {
  --color-surface: var(--bg-primary);
  --color-surface-secondary: var(--bg-secondary);
  --color-surface-sidebar: var(--bg-sidebar);
  --color-hover: var(--bg-hover);
  --color-active: var(--bg-active);
  --color-primary: var(--text-primary);
  --color-secondary: var(--text-secondary);
  --color-tertiary: var(--text-tertiary);
  --color-border: var(--border);
  --color-accent: var(--accent);
  --color-accent-hover: var(--accent-hover);
  --color-heart: var(--color-heart);
  --color-success: var(--color-success);
  --color-error: var(--color-error);
  --color-warning: var(--color-warning);
  --color-info: var(--color-info);
  --font-serif: var(--font-serif);
  --width-sidebar: var(--sidebar-width);
}

/* ==========================================================================
   Accessibility Utilities
   ========================================================================== */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.sr-only.focus\:not-sr-only:focus {
  position: absolute;
  width: auto;
  height: auto;
  padding: inherit;
  margin: inherit;
  overflow: visible;
  clip: auto;
  white-space: normal;
}

/* ==========================================================================
   Base Styles
   ========================================================================== */
* {
  box-sizing: border-box;
}

html {
  height: 100%;
  margin: 0;
  padding: 0;
  overflow-x: hidden;
}

body {
  height: 100%;
  margin: 0;
  padding: 0;
  overflow-x: hidden;
  position: relative;
  width: 100%;
  background: var(--bg-primary);
  color: var(--text-primary);
  -webkit-font-smoothing: antialiased;
  font-family: var(--font-serif);
  transition: background-color 0.2s ease, color 0.2s ease;
}

/* ==========================================================================
   Main Content Area - Clean, no page effects
   ========================================================================== */
main {
  background: var(--bg-primary);
  min-height: 100vh;
  position: relative;
  max-width: 100vw;
  overflow-x: hidden;
}

/* ==========================================================================
   Scrollbar Styling
   ========================================================================== */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--bg-secondary);
}

::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--text-tertiary);
}

/* ==========================================================================
   Selection - uses accent color
   ========================================================================== */
::selection {
  background: color-mix(in srgb, var(--accent) 25%, transparent);
}

[data-theme="dark"] ::selection {
  background: color-mix(in srgb, var(--accent) 35%, transparent);
}

/* ==========================================================================
   Poem Content Styling
   ========================================================================== */
article {
  font-family: var(--font-serif);
  line-height: 1.8;
}

/* Poem content renderer - in @layer base to override Tailwind's preflight */
@layer base {
  .poem-content {
    font-family: var(--font-serif);
    max-width: 100%;
    overflow-x: hidden;
    white-space: pre-wrap;
    overflow-wrap: anywhere;
    word-break: break-word;
  }

  .poem-content p {
    margin: 0;
    min-height: 1.8em;
    white-space: pre-wrap;
    overflow-wrap: anywhere;
    word-break: break-word;
  }

  .poem-content p:has(br:only-child),
  .poem-content p:empty {
    min-height: 1.8em;
  }

  .poem-content strong,
  .poem-content b {
    font-weight: 700;
  }

  .poem-content em,
  .poem-content i {
    font-style: italic;
  }

  .poem-content u {
    text-decoration: underline;
  }
}

/* ==========================================================================
   Link Styling
   ========================================================================== */
a {
  transition: color 0.2s ease;
}

/* ==========================================================================
   Button Styling - Accessibility
   ========================================================================== */
button,
[role="button"],
input[type="submit"],
input[type="button"] {
  cursor: pointer;
}

button:disabled,
[role="button"][aria-disabled="true"],
input[type="submit"]:disabled,
input[type="button"]:disabled {
  cursor: not-allowed;
}


/* ==========================================================================
   Mobile-First Responsive Layout
   ========================================================================== */

/* Mobile: Add top padding for fixed header */
@media (max-width: 767px) {
  main {
    padding-top: var(--mobile-header-height);
  }
}

/* Desktop: Add left margin for sidebar (uses dynamic width for collapse) */
/* Only applies to pages with .has-sidebar wrapper */
@media (min-width: 768px) {
  .has-sidebar main {
    margin-left: var(--sidebar-current-width);
    transition: margin-left 0.3s ease;
  }
}

/* ==========================================================================
   Mobile Sidebar Overlay
   ========================================================================== */
.sidebar-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: 45;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}

.sidebar-overlay.open {
  opacity: 1;
  visibility: visible;
}

.sidebar-mobile {
  transform: translateX(-100%);
  transition: transform 0.3s ease;
  /* Fallback for browsers that don't support dvh */
  height: 100vh;
  height: 100dvh;
}

.sidebar-mobile.open {
  transform: translateX(0);
}

/* ==========================================================================
   Smooth Page Transitions
   ========================================================================== */
.page-content {
  animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateX(100%);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.animate-slide-in {
  animation: slideIn 0.3s ease-out;
}

/* ==========================================================================
   Touch Target Sizing (Accessibility)
   ========================================================================== */
@media (pointer: coarse) {
  button,
  a,
  input[type="checkbox"],
  input[type="radio"] {
    min-height: 44px;
    min-width: 44px;
  }
}
